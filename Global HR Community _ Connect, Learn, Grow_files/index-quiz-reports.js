(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.i18n,r=window.React;var s=e.n(r);class a extends s().Component{constructor(e){super(e)}render(){let e="",s="";return 1==this.props.text&&(s=(0,r.createElement)("span",{className:"supporting-text"},(0,t.__)("Your report is being generated.","learndash-reports-by-wisdmlabs"))),e=(0,r.createElement)("div",{class:"wisdm-learndash-reports-chart-block"},(0,r.createElement)("div",{class:"wisdm-learndash-reports-revenue-from-courses graph-card-container"},(0,r.createElement)("div",{class:"wisdm-graph-loading"},(0,r.createElement)("img",{src:wisdm_learndash_reports_front_end_script_total_revenue_earned.plugin_asset_url+"/images/loader.svg"}),s))),e}}const o=a;function n(e,t,r,s,a){change_entry_count(e,t),change_page_number(e,r,s,a)}function i(e,t){if(void 0===t)return;if(t.hasOwnProperty("length"))return;var r=null,s="",a=null,o="";let n=t.limit*(t.page-1);for(var i=0;i<t.data.length;i++)jQuery(window).width()<1500&&(s=(r=jQuery(t.data[i].quiz_title)).text().substring(0,30),r.text().length>30&&(s+="..."),r.text(s),t.data[i].quiz_title=r.outerHTML(),o=(a=jQuery(t.data[i].user_name)).text().substring(0,30),a.text().length>30&&(o+="..."),a.text(o),t.data[i].user_name=a.outerHTML()),t.data[i].index=n+(i+1);jQuery(e).DataTable({paging:!1,ordering:!1,searching:!1,info:!1,responsive:!1,data:t.data,columns:[{data:"index"},{data:"quiz_title"},{data:"user_name"},{data:"date_attempt"},{data:"score"},{data:"time_taken"},{data:"link"}],columnDefs:[{targets:[0,3,4,5,6],className:"dt-center"},{targets:[1,2],className:"dt-left"}],language:{emptyTable:t.no_data}})}function l(e,t,r=qre_export_obj.first_custom_url){var s={},a=document.createElement("a");a.href=r;for(var o=a.search.split(/\?|&/),n=0;n<o.length;n++)if(o[n]){var i=o[n].split("=");s[i[0]]=i[1]}s[e]=t;var l=[];return Object.keys(s).forEach((function(e){l.push(e+"="+s[e])})),a.search="?"+l.join("&"),a.href}function u(e){if(e<1)return!1;jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,{action:"get_quiz_reports_data",report:"custom",page:e,pageno:e,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},(function(e){jQuery(".wisdm-learndash-reports-quiz-reports").html(e.data.html),i("#qre_summarized_data",e.data.entries),jQuery("div.pagination-section > a").click((function(e){e.preventDefault(),u(function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}("paged",jQuery(this).attr("href")))}));let t=document.getElementsByClassName("wrld-loader");t.length>0&&ReactDOM.render(s().createElement(o),t[0])}))}document.addEventListener("wisdm-ld-reports-report-type-selected",(function(e){if("quiz-reports"==e.detail.active_reports_tab){if(!wisdm_ld_reports_common_script_data.is_pro_version_active){let e="";wisdm_ld_reports_common_script_data.is_admin_user&&(e='<div><a class="wrld-upgrade-btn" target="__blank" href="https://www.learndash.com/reports-by-learndash">'+(0,t.__)("Upgrade to PRO","learndash-reports-by-wisdmlabs")+"</a></div> <span>"+(0,t.__)("OR","learndash-reports-by-wisdmlabs")+"</span>");const r="<img src="+wisdm_ld_reports_common_script_data.plugin_asset_url+"'/images/qrt.png'}></img>",s='<div class="wrld-upgrade-container"><div class="wrld-upgrade-content"><span>'+(0,t.__)("Available in LearnDash LMS - Reports PRO","learndash-reports-by-wisdmlabs")+"</span>"+e+'<div><a class="wrld-learn-more" target="__blank" href="https://www.learndash.com/reports-by-learndash">'+(0,t.__)("Learn More","learndash-reports-by-wisdmlabs")+"</a></div></div></div>";jQuery(".wisdm-learndash-reports-quiz-reports").html(r),jQuery(".wisdm-learndash-reports-quiz-reports").append(s),jQuery(".wisdm-learndash-reports-quiz-reports").parent().addClass("wrld-dummy-report")}jQuery(".wisdm-learndash-reports-quiz-reports").parent().show();let e=document.getElementsByClassName("wrld-loader");e.length>0&&ReactDOM.render(s().createElement(o),e[0])}else jQuery(".wisdm-learndash-reports-quiz-reports").parent().hide()})),document.addEventListener("wisdm-ld-reports-default-quiz-report-filters-applied",(function(e){let t=l("ld_report_type","quiz-reports");t=l("report","quiz",t),t=l("period","year",t),t=l("from_date","",t),t=l("to_date","",t),t=l("qre_search_field",e.detail.selection_label,t),t=l("search_result_id",e.detail.selection_id,t),t=l(e.detail.selection_type,e.detail.selection_id,t);let r="post";"quiz"==e.detail.selection_type?r="post":"user"==e.detail.selection_type&&(r="user");let a=1,u=jQuery("div.pagination-section > input.page").val();null!=u&&u>0&&(a=u),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,{action:"get_quiz_reports_data",report:e.detail.report_selector,search_result_type:r,search_result_id:e.detail.selection_id,qre_search_field:e.detail.selection_label,page:a,pageno:a,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},(function(e){jQuery(".wisdm-learndash-reports-quiz-reports").html(e.data.html),jQuery(".wrld-loader").hide(),wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams=null!=e.data.entries.query_params?e.data.entries.query_params:[],i("#qre_summarized_data",e.data.entries),n(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page");let t=document.getElementsByClassName("wrld-loader");t.length>0&&ReactDOM.render(s().createElement(o),t[0])}))})),document.addEventListener("wisdm-ld-reports-default-custom-quiz-report-filters-applied",(function(e){let t=e.detail.fields_selected;t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"qre_save_filters",security:qre_export_obj.custom_reports_nonce,fields:t},success:function(e){jQuery(document).trigger("custom_reports_config_set"),u(1),jQuery("div.pagination-section > a").click((function(e){e.preventDefault(),console.log(e)}));let t=document.getElementsByClassName("wrld-loader");t.length>0&&ReactDOM.render(s().createElement(o),t[0])},error:function(e,t,r){if("timeout"===t){if(this.retry_count++,this.retry_count<=this.retry_limit)return console.log("Retrying"),void jQuery.ajax(this);console.error("request timed out"),jQuery(document).trigger("custom_reports_config_set")}else console.log(r),jQuery(document).trigger("custom_reports_config_set")}})})),document.addEventListener("wisdm-ld-reports-custom-quiz-report-filters-applied",(function(e){let t=e.detail.fields_selected;t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"qre_save_filters",security:qre_export_obj.custom_reports_nonce,fields:t},success:function(e){u(1)},error:function(e,t,r){if("timeout"===t){if(this.retry_count++,this.retry_count<=this.retry_limit)return console.log("Retrying"),void jQuery.ajax(this);console.error("request timed out"),jQuery(document).trigger("custom_reports_config_set")}else console.log(r),jQuery(document).trigger("custom_reports_config_set")}}),document.getElementById("wisdm-learndash-reports-quiz-report-view").scrollIntoView()})),document.addEventListener("wrld-fetch-export-data-count",(function(e){let t={};var r;t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,r=t,jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_entries",security:qre_export_obj.custom_reports_nonce,fields:r},success:function(e){jQuery(".bulk-export-heading div span").text(e.data.count.attempt_count)}})})),document.addEventListener("wrld-bulk-export-attempt-results-success",(function(e){jQuery(".export-attempt-results .bulk-export-progress").addClass("wrld-hidden"),jQuery(".export-attempt-results .bulk-export-progress progress").val(0),jQuery(".export-attempt-results .bulk-export-progress span").text(""),jQuery(".export-attempt-results .bulk-export-download").append('<a class="button btn btn-primary" href="'+e.detail.result.data.link+'" download><span class="dashicons dashicons-download"></span>Download '+e.detail.filetype.toUpperCase()+"</a>"),jQuery(".export-attempt-results .bulk-export-download").removeClass("wrld-hidden")})),document.addEventListener("wrld-bulk-export-learner-results-success",(function(e){jQuery(".export-attempt-learner-answers .bulk-export-progress").addClass("wrld-hidden"),jQuery(".export-attempt-learner-answers .bulk-export-progress progress").val(0),jQuery(".export-attempt-learner-answers .bulk-export-progress span").text(""),jQuery(".export-attempt-learner-answers .bulk-export-download").append('<a class="button btn btn-primary" href="'+e.detail.result.data.link+'" download><span class="dashicons dashicons-download"></span>Download '+e.detail.filetype.toUpperCase()+"</a>"),jQuery(".export-attempt-learner-answers .bulk-export-download").removeClass("wrld-hidden")})),document.addEventListener("wrld-bulk-export-attempt-results",(function(e){jQuery(".export-attempt-results .bulk-export-progress label").text(e.detail.type.toUpperCase()+" export in progress"),jQuery(".export-attempt-results .bulk-export-progress").removeClass("wrld-hidden");var t=0,r=(jQuery(".export-attempt-results .report-export-buttons div span").text(),setInterval((function(){jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_progress_results",security:qre_export_obj.custom_reports_nonce},success:function(e){(t=e.data.percentage)<=100&&(jQuery(".export-attempt-results .bulk-export-progress progress").val(t),jQuery(".export-attempt-results .bulk-export-progress span").text(t+"% Complete")),t>=100&&clearInterval(r)},error:function(e,t,r){if("timeout"===t){if(this.retry_count++,this.retry_count<=this.retry_limit)return console.log("Retrying"),void jQuery.ajax(this);console.error("request timed out")}else console.log(r)}})}),1e3))})),document.addEventListener("wrld-bulk-export-learner-results",(function(e){jQuery(".export-attempt-learner-answers .bulk-export-progress label").text(e.detail.type.toUpperCase()+" export in progress"),jQuery(".export-attempt-learner-answers .bulk-export-progress").removeClass("wrld-hidden");var t=0,r=(jQuery(".export-attempt-results .report-export-buttons div span").text(),setInterval((function(){jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_progress_results",security:qre_export_obj.custom_reports_nonce},success:function(e){(t=e.data.percentage)<=100&&(jQuery(".export-attempt-learner-answers .bulk-export-progress progress").val(t),jQuery(".export-attempt-learner-answers .bulk-export-progress span").text(t+"% Complete")),t>=100&&clearInterval(r)},error:function(e,t,r){if("timeout"===t){if(this.retry_count++,this.retry_count<=this.retry_limit)return console.log("Retrying"),void jQuery.ajax(this);console.error("request timed out")}else console.log(r)}})}),1e3))})),document.addEventListener("wrld-bulk-export-attempt-results",(function(e){let t={};t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.type=e.detail.type,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".filter-section").css({opacity:.5,"pointer-events":"none"}),jQuery(".bulk-export-download").css({opacity:.5,"pointer-events":"none"}),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_attempt_results",security:qre_export_obj.custom_reports_nonce,fields:t},success:function(t){jQuery(".filter-section").css({opacity:1,"pointer-events":"auto"}),jQuery(".bulk-export-download").css({opacity:1,"pointer-events":"auto"});const r=new CustomEvent("wrld-bulk-export-attempt-results-success",{detail:{result:t,filetype:e.detail.type}});document.dispatchEvent(r)},error:function(e,t,r){if("timeout"===t){if(this.retry_count++,this.retry_count<=this.retry_limit)return console.log("Retrying"),void jQuery.ajax(this);console.error("request timed out")}else console.log(r)}})})),document.addEventListener("wrld-bulk-export-learner-results",(function(e){let t={};t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.type=e.detail.type,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".filter-section").css({opacity:.5,"pointer-events":"none"}),jQuery(".bulk-export-download").css({opacity:.5,"pointer-events":"none"}),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_learner_results",security:qre_export_obj.custom_reports_nonce,fields:t},success:function(t){jQuery(".filter-section").css({opacity:1,"pointer-events":"auto"}),jQuery(".bulk-export-download").css({opacity:1,"pointer-events":"auto"});const r=new CustomEvent("wrld-bulk-export-learner-results-success",{detail:{result:t,filetype:e.detail.type}});document.dispatchEvent(r)},error:function(e,t,r){if("timeout"===t){if(this.retry_count++,this.retry_count<=this.retry_limit)return console.log("Retrying"),void jQuery.ajax(this);console.error("request timed out")}else console.log(r)}})})),document.addEventListener("wisdm-ld-custom-report-type-select",(function(e){if(jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),"custom"==e.detail.report_selector)u(1);else{let t=1;jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,{action:"get_quiz_reports_data",report:e.detail.report_selector,page:t,pageno:t,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},(function(t){jQuery(".wisdm-learndash-reports-quiz-reports").html(t.data.html),i("#qre_summarized_data",t.data.entries),""==e.detail.report_selector&&n(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page");let r=document.getElementsByClassName("wrld-loader");r.length>0&&ReactDOM.render(s().createElement(o),r[0])}))}})),window.change_entry_count=function(e,t){jQuery(t).on("change",(function(){let e={action:"get_quiz_reports_data",page:1,pageno:1,limit:jQuery(this).find("option:selected").val(),wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},t=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(t,(function(t,r){if(null!=e[t])return!0;null!==r&&(e[t]=r)})),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,e,(function(e){jQuery(".wisdm-learndash-reports-quiz-reports").html(e.data.html),i("#qre_summarized_data",e.data.entries),n(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page");let t=document.getElementsByClassName("wrld-loader");t.length>0&&ReactDOM.render(s().createElement(o),t[0])}))}))},window.change_page_number=function(e,t,r,a){jQuery(t).on("change",(function(){var e=parseInt(jQuery(this).val()),r=parseInt(jQuery(this).attr("data-max"));if(isNaN(e))return!1;if(e>r)return!1;let s=jQuery("select.limit").find("option:selected").val(),a={action:"get_quiz_reports_data",page:e,pageno:e,limit:s,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},o=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(o,(function(e,t){if(null!=a[e])return!0;null!==t&&(a[e]=t)})),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,a,(function(r){jQuery(".wisdm-learndash-reports-quiz-reports").html(r.data.html),i("#qre_summarized_data",r.data.entries),n(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page"),jQuery(t).val(e)}))})),jQuery(a).on("click",(function(){var e=parseInt(jQuery(t).val()),r=parseInt(jQuery(t).attr("data-max"));if(e===r)return jQuery(this).attr("disabled","disabled"),!1;let a=jQuery("select.limit").find("option:selected").val(),l={action:"get_quiz_reports_data",page:e+1,pageno:e+1,limit:a,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},u=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(u,(function(e,t){if(null!=l[e])return!0;null!==t&&(l[e]=t)})),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,l,(function(r){jQuery(".wisdm-learndash-reports-quiz-reports").html(r.data.html),i("#qre_summarized_data",r.data.entries),n(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page"),jQuery(t).val(e+1);let a=document.getElementsByClassName("wrld-loader");a.length>0&&ReactDOM.render(s().createElement(o),a[0])}))})),jQuery(r).on("click",(function(){var e=parseInt(jQuery(t).val());if(1===e)return jQuery(this).attr("disabled","disabled"),!1;if((e-=1)<1)return!1;let r=jQuery("select.limit").find("option:selected").val(),a={action:"get_quiz_reports_data",page:e,pageno:e,limit:r,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},l=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(l,(function(e,t){if(null!=a[e])return!0;null!==t&&(a[e]=t)})),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,a,(function(r){jQuery(".wisdm-learndash-reports-quiz-reports").html(r.data.html),i("#qre_summarized_data",r.data.entries),n(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page"),jQuery(t).val(e);let a=document.getElementsByClassName("wrld-loader");a.length>0&&ReactDOM.render(s().createElement(o),a[0])}))}))},jQuery(".mb-40").each((function(e,t){0==jQuery(t).text().trim().length&&jQuery(t).css({"margin-bottom":"0px"})})),document.addEventListener("DOMContentLoaded",(function(e){"quiz-reports"==wisdm_learndash_reports_front_end_script_quiz_reports.report_type?(jQuery(".wisdm-learndash-reports-quiz-reports").parent().show(),jQuery(".ld-course-field").hide(),document.getElementById("wisdm-learndash-reports-quiz-report-view").scrollIntoView()):(jQuery(".wisdm-learndash-reports-quiz-reports").parent().hide(),jQuery(".ld-course-field").css("display","flex")),jQuery(".qre-reports-content .back-button").on("click",(function(e){e.preventDefault(),open(location,"_self").close()}))}))})();